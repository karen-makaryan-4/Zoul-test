<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Deep Link Redirect</title>
    <script>
      function redirectToApp() {
        const audioId = new URLSearchParams(window.location.search).get(
          'audioId'
        );
        if (audioId) {
          const appScheme = `zoul://?audioId=${audioId}`;
          const appStoreURL = 'itms-apps://itunes.apple.com/app/id6502774439';
          const playStoreURL = 'market://details?id=com.zoul.app';

          const start = new Date().getTime();
          let timeout;

          if (navigator.userAgent.match(/Android/i)) {
            timeout = setTimeout(() => {
              window.location.href = playStoreURL;
            }, 1000);
          } else if (navigator.userAgent.match(/iPhone|iPad|iPod/i)) {
            timeout = setTimeout(() => {
              window.location.href = appStoreURL;
            }, 1000);
          }

          window.location.href = appScheme;

          window.addEventListener('blur', () => {
            clearTimeout(timeout);
          });
        } else {
          window.location.href = 'https://www.zoul.app';
        }
      }
    </script>
  </head>
  <body onload="redirectToApp()">
    <h1>Deep Link Test 2</h1>
  </body>
</html>
